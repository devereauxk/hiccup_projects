['/global/u1/k/kdevero/hiccup_projects/pp_unfolding', '/global/common/software/nersc/pm-2022q4/sw/tensorflow/2.9.0/lib/python39.zip', '/global/common/software/nersc/pm-2022q4/sw/tensorflow/2.9.0/lib/python3.9', '/global/common/software/nersc/pm-2022q4/sw/tensorflow/2.9.0/lib/python3.9/lib-dynload', '/global/homes/k/kdevero/.local/perlmutter/tensorflow2.9.0/lib/python3.9/site-packages', '/global/common/software/nersc/pm-2022q4/sw/tensorflow/2.9.0/lib/python3.9/site-packages']
[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
True
unfolding on : jet-level data
config file : config_omnifold.json
closure test : True
################################################################################
Total hvd size: 1, rank: 0, local size: 1, local rank: 0
################################################################################
natural data
       gen_energy_weight       gen_R_L    gen_jet_pt  obs_energy_weight  \
count       2.779551e+06  2.779551e+06  2.779551e+06       2.779551e+06   
mean        4.612885e-03  2.568717e-01  2.750827e+01      -5.878186e+03   
std         1.113615e-02  1.532965e-01  5.276562e+00       4.921681e+03   
min         1.464898e-05  0.000000e+00  2.000160e+01      -9.999000e+03   
25%         6.140266e-04  1.427859e-01  2.305824e+01      -9.999000e+03   
50%         1.681536e-03  2.485288e-01  2.653792e+01      -9.999000e+03   
75%         4.551469e-03  3.604377e-01  3.133224e+01       1.583496e-03   
max         1.000000e+00  8.997835e-01  3.999644e+01       1.000000e+00   

            obs_R_L    obs_jet_pt    obs_thrown  
count  2.779551e+06  2.779551e+06  2.779551e+06  
mean  -5.878089e+03 -5.867514e+03  5.878777e-01  
std    4.921798e+03  4.934428e+03  4.922170e-01  
min   -9.999000e+03 -9.999000e+03  0.000000e+00  
25%   -9.999000e+03 -9.999000e+03  0.000000e+00  
50%   -9.999000e+03 -9.999000e+03  1.000000e+00  
75%    1.920013e-01  2.371305e+01  1.000000e+00  
max    8.487079e-01  3.991891e+01  1.000000e+00  
   gen_energy_weight   gen_R_L  gen_jet_pt  obs_energy_weight      obs_R_L  \
0           0.003826  0.000000   38.481551           0.004109     0.000000   
1           0.000886  0.532620   38.481551           0.000959     0.529147   
2           0.000829  0.525144   38.481551           0.000907     0.518598   
3           0.003248  0.247525   38.481551       -9999.000000 -9999.000000   
4           0.006522  0.431914   38.481551           0.007006     0.428856   
5           0.005214  0.360886   38.481551           0.005631     0.358359   
6           0.004160  0.432882   38.481551           0.004443     0.438719   
7           0.028960  0.361527   38.481551           0.032054     0.351557   
8           0.008348  0.347887   38.481551           0.009146     0.343450   
9           0.000886  0.532620   38.481551           0.000959     0.529147   

    obs_jet_pt  obs_thrown  
0    36.911131         0.0  
1    36.911131         0.0  
2    36.911131         0.0  
3 -9999.000000         1.0  
4    36.911131         0.0  
5    36.911131         0.0  
6    36.911131         0.0  
7    36.911131         0.0  
8    36.911131         0.0  
9    36.911131         0.0  
synthetic data
         gen_energy_weight   gen_R_L  gen_jet_pt  obs_energy_weight  \
4336225           0.000699  0.218120    23.38972       -9999.000000   
4336226           0.000938  0.175463    23.38972           0.001137   
4336227           0.000204  0.153547    23.38972           0.000244   
4336228           0.000587  0.145945    23.38972           0.000707   
4336229           0.002183  0.039015    23.38972           0.002620   
4336230           0.000303  0.122014    23.38972       -9999.000000   
4336231           0.001020  0.087804    23.38972           0.001227   
4336232           0.001468  0.082015    23.38972           0.001755   
4336233           0.004227  0.043068    23.38972           0.005114   
4336234           0.000347  0.000000    23.38972           0.000413   

             obs_R_L  obs_jet_pt  obs_thrown  
4336225 -9999.000000 -9999.00000         1.0  
4336226     0.177951    21.17145         0.0  
4336227     0.152391    21.17145         0.0  
4336228     0.145946    21.17145         0.0  
4336229     0.039518    21.17145         0.0  
4336230 -9999.000000 -9999.00000         1.0  
4336231     0.087034    21.17145         0.0  
4336232     0.083920    21.17145         0.0  
4336233     0.043945    21.17145         0.0  
4336234     0.000000    21.17145         0.0  
################################################################################
[[ 1.57630126e-03  0.00000000e+00 ... -9.99900000e+03 -9.99900000e+03]
 [ 6.91018931e-04  4.97035278e-01 ... -9.99900000e+03 -9.99900000e+03]
 ...
 [ 4.21793199e-03  4.21660630e-02 ...  4.30065442e-02  5.85725218e-02]
 [ 3.46839538e-04  0.00000000e+00 ...  0.00000000e+00  5.85725218e-02]]
################################################################################
[[[ 1.57630126e-03  0.00000000e+00 ... -9.99900000e+03 -9.99900000e+03]
  [ 6.91018931e-04  4.97035278e-01 ... -9.99900000e+03 -9.99900000e+03]
  ...
  [-1.00000000e+00 -1.00000000e+00 ... -1.00000000e+00 -1.00000000e+00]
  [-1.00000000e+00 -1.00000000e+00 ... -1.00000000e+00 -1.00000000e+00]]

 [[ 2.62251392e-04  0.00000000e+00 ... -9.99900000e+03 -9.99900000e+03]
  [ 6.28076105e-04  4.69121439e-01 ... -9.99900000e+03 -9.99900000e+03]
  ...
  [-1.00000000e+00 -1.00000000e+00 ... -1.00000000e+00 -1.00000000e+00]
  [-1.00000000e+00 -1.00000000e+00 ... -1.00000000e+00 -1.00000000e+00]]

 ...

 [[ 6.78095924e-04  0.00000000e+00 ... -9.99900000e+03 -9.99900000e+03]
  [ 3.15059406e-04  1.21426260e-01 ... -9.99900000e+03 -9.99900000e+03]
  ...
  [-1.00000000e+00 -1.00000000e+00 ... -1.00000000e+00 -1.00000000e+00]
  [-1.00000000e+00 -1.00000000e+00 ... -1.00000000e+00 -1.00000000e+00]]

 [[ 5.44035136e-05  0.00000000e+00 ... -9.99900000e+03 -9.99900000e+03]
  [ 3.33491758e-04  1.57211723e-01 ... -9.99900000e+03 -9.99900000e+03]
  ...
  [-1.00000000e+00 -1.00000000e+00 ... -1.00000000e+00 -1.00000000e+00]
  [-1.00000000e+00 -1.00000000e+00 ... -1.00000000e+00 -1.00000000e+00]]]
################################################################################
[[[-9.999e+03 -9.999e+03 -9.999e+03]
  [-9.999e+03 -9.999e+03 -9.999e+03]
  ...
  [-1.000e+00 -1.000e+00 -1.000e+00]
  [-1.000e+00 -1.000e+00 -1.000e+00]]

 [[-9.999e+03 -9.999e+03 -9.999e+03]
  [-9.999e+03 -9.999e+03 -9.999e+03]
  ...
  [-1.000e+00 -1.000e+00 -1.000e+00]
  [-1.000e+00 -1.000e+00 -1.000e+00]]

 ...

 [[-9.999e+03 -9.999e+03 -9.999e+03]
  [-9.999e+03 -9.999e+03 -9.999e+03]
  ...
  [-1.000e+00 -1.000e+00 -1.000e+00]
  [-1.000e+00 -1.000e+00 -1.000e+00]]

 [[-9.999e+03 -9.999e+03 -9.999e+03]
  [-9.999e+03 -9.999e+03 -9.999e+03]
  ...
  [-1.000e+00 -1.000e+00 -1.000e+00]
  [-1.000e+00 -1.000e+00 -1.000e+00]]]
using full available data...
	 mc set size : 24196 pairs/jets/events
	 natural set size : 12469 pairs/jets/events
HVD data vars (12469, 600, 3)
[[[ 4.10075389e-03  0.00000000e+00  8.45556549e-01]
  [ 9.58579076e-04  4.24710137e-01  8.45556549e-01]
  ...
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]]

 [[ 7.85630064e-04  0.00000000e+00  5.25604790e-01]
  [ 8.11279290e-04  4.37035976e-01  5.25604790e-01]
  ...
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]]

 ...

 [[ 7.67016070e-05  0.00000000e+00  6.99391643e-01]
  [ 1.11735660e-04  3.93186845e-01  6.99391643e-01]
  ...
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]]

 [[-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]
  ...
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]]]
HVD mc reco (24196, 600, 3)
[[[-1. -1. -1.]
  [-1. -1. -1.]
  ...
  [-1. -1. -1.]
  [-1. -1. -1.]]

 [[-1. -1. -1.]
  [-1. -1. -1.]
  ...
  [-1. -1. -1.]
  [-1. -1. -1.]]

 ...

 [[-1. -1. -1.]
  [-1. -1. -1.]
  ...
  [-1. -1. -1.]
  [-1. -1. -1.]]

 [[-1. -1. -1.]
  [-1. -1. -1.]
  ...
  [-1. -1. -1.]
  [-1. -1. -1.]]]
HVD mc gen (24196, 600, 3)
[[[ 1.57630126e-03  0.00000000e+00  8.28899668e-02]
  [ 6.91018931e-04  4.97035278e-01  8.28899668e-02]
  ...
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]]

 [[ 2.62251392e-04  0.00000000e+00  6.76936566e-01]
  [ 6.28076105e-04  4.69121439e-01  6.76936566e-01]
  ...
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]]

 ...

 [[ 6.78095924e-04  0.00000000e+00  7.83933979e-02]
  [ 3.15059406e-04  1.21426260e-01  7.83933979e-02]
  ...
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]]

 [[ 5.44035136e-05  0.00000000e+00  6.35526200e-01]
  [ 3.33491758e-04  1.57211723e-01  6.35526200e-01]
  ...
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]
  [-1.00000000e+00 -1.00000000e+00 -1.00000000e+00]]]
performing multifold to get weights ... 
model input shape : (600, 3)
===== MODEL 1 =====
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 600, 3)]     0           []                               
                                                                                                  
 dense (Dense)                  (None, 600, 64)      256         ['input_1[0][0]']                
                                                                                                  
 dense_4 (Dense)                (None, 600, 64)      256         ['input_1[0][0]']                
                                                                                                  
 dense_8 (Dense)                (None, 600, 64)      256         ['input_1[0][0]']                
                                                                                                  
 dense_12 (Dense)               (None, 600, 64)      256         ['input_1[0][0]']                
                                                                                                  
 dense_16 (Dense)               (None, 600, 64)      256         ['input_1[0][0]']                
                                                                                                  
 dense_20 (Dense)               (None, 600, 64)      256         ['input_1[0][0]']                
                                                                                                  
 dense_24 (Dense)               (None, 600, 64)      256         ['input_1[0][0]']                
                                                                                                  
 dense_28 (Dense)               (None, 600, 64)      256         ['input_1[0][0]']                
                                                                                                  
 dense_32 (Dense)               (None, 600, 64)      256         ['input_1[0][0]']                
                                                                                                  
 dense_36 (Dense)               (None, 600, 64)      256         ['input_1[0][0]']                
                                                                                                  
 dense_1 (Dense)                (None, 600, 128)     8320        ['dense[0][0]']                  
                                                                                                  
 dense_5 (Dense)                (None, 600, 128)     8320        ['dense_4[0][0]']                
                                                                                                  
 dense_9 (Dense)                (None, 600, 128)     8320        ['dense_8[0][0]']                
                                                                                                  
 dense_13 (Dense)               (None, 600, 128)     8320        ['dense_12[0][0]']               
                                                                                                  
 dense_17 (Dense)               (None, 600, 128)     8320        ['dense_16[0][0]']               
                                                                                                  
 dense_21 (Dense)               (None, 600, 128)     8320        ['dense_20[0][0]']               
                                                                                                  
 dense_25 (Dense)               (None, 600, 128)     8320        ['dense_24[0][0]']               
                                                                                                  
 dense_29 (Dense)               (None, 600, 128)     8320        ['dense_28[0][0]']               
                                                                                                  
 dense_33 (Dense)               (None, 600, 128)     8320        ['dense_32[0][0]']               
                                                                                                  
 dense_37 (Dense)               (None, 600, 128)     8320        ['dense_36[0][0]']               
                                                                                                  
 dense_2 (Dense)                (None, 600, 64)      8256        ['dense_1[0][0]']                
                                                                                                  
 dense_6 (Dense)                (None, 600, 64)      8256        ['dense_5[0][0]']                
                                                                                                  
 dense_10 (Dense)               (None, 600, 64)      8256        ['dense_9[0][0]']                
                                                                                                  
 dense_14 (Dense)               (None, 600, 64)      8256        ['dense_13[0][0]']               
                                                                                                  
 dense_18 (Dense)               (None, 600, 64)      8256        ['dense_17[0][0]']               
                                                                                                  
 dense_22 (Dense)               (None, 600, 64)      8256        ['dense_21[0][0]']               
                                                                                                  
 dense_26 (Dense)               (None, 600, 64)      8256        ['dense_25[0][0]']               
                                                                                                  
 dense_30 (Dense)               (None, 600, 64)      8256        ['dense_29[0][0]']               
                                                                                                  
 dense_34 (Dense)               (None, 600, 64)      8256        ['dense_33[0][0]']               
                                                                                                  
 dense_38 (Dense)               (None, 600, 64)      8256        ['dense_37[0][0]']               
                                                                                                  
 flatten (Flatten)              (None, 38400)        0           ['dense_2[0][0]']                
                                                                                                  
 flatten_1 (Flatten)            (None, 38400)        0           ['dense_6[0][0]']                
                                                                                                  
 flatten_2 (Flatten)            (None, 38400)        0           ['dense_10[0][0]']               
                                                                                                  
 flatten_3 (Flatten)            (None, 38400)        0           ['dense_14[0][0]']               
                                                                                                  
 flatten_4 (Flatten)            (None, 38400)        0           ['dense_18[0][0]']               
                                                                                                  
 flatten_5 (Flatten)            (None, 38400)        0           ['dense_22[0][0]']               
                                                                                                  
 flatten_6 (Flatten)            (None, 38400)        0           ['dense_26[0][0]']               
                                                                                                  
 flatten_7 (Flatten)            (None, 38400)        0           ['dense_30[0][0]']               
                                                                                                  
 flatten_8 (Flatten)            (None, 38400)        0           ['dense_34[0][0]']               
                                                                                                  
 flatten_9 (Flatten)            (None, 38400)        0           ['dense_38[0][0]']               
                                                                                                  
 dense_3 (Dense)                (None, 1)            38401       ['flatten[0][0]']                
                                                                                                  
 dense_7 (Dense)                (None, 1)            38401       ['flatten_1[0][0]']              
                                                                                                  
 dense_11 (Dense)               (None, 1)            38401       ['flatten_2[0][0]']              
                                                                                                  
 dense_15 (Dense)               (None, 1)            38401       ['flatten_3[0][0]']              
                                                                                                  
 dense_19 (Dense)               (None, 1)            38401       ['flatten_4[0][0]']              
                                                                                                  
 dense_23 (Dense)               (None, 1)            38401       ['flatten_5[0][0]']              
                                                                                                  
 dense_27 (Dense)               (None, 1)            38401       ['flatten_6[0][0]']              
                                                                                                  
 dense_31 (Dense)               (None, 1)            38401       ['flatten_7[0][0]']              
                                                                                                  
 dense_35 (Dense)               (None, 1)            38401       ['flatten_8[0][0]']              
                                                                                                  
 dense_39 (Dense)               (None, 1)            38401       ['flatten_9[0][0]']              
                                                                                                  
 tf.math.reduce_mean (TFOpLambd  (None, 1)           0           ['dense_3[0][0]',                
 a)                                                               'dense_7[0][0]',                
                                                                  'dense_11[0][0]',               
                                                                  'dense_15[0][0]',               
                                                                  'dense_19[0][0]',               
                                                                  'dense_23[0][0]',               
                                                                  'dense_27[0][0]',               
                                                                  'dense_31[0][0]',               
                                                                  'dense_35[0][0]',               
                                                                  'dense_39[0][0]']               
                                                                                                  
==================================================================================================
Total params: 552,330
Trainable params: 552,330
Non-trainable params: 0
__________________________________________________________________________________________________
===== MODEL 1B =====
Model: "model_1"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_2 (InputLayer)           [(None, 600, 3)]     0           []                               
                                                                                                  
 dense_40 (Dense)               (None, 600, 64)      256         ['input_2[0][0]']                
                                                                                                  
 dense_44 (Dense)               (None, 600, 64)      256         ['input_2[0][0]']                
                                                                                                  
 dense_48 (Dense)               (None, 600, 64)      256         ['input_2[0][0]']                
                                                                                                  
 dense_52 (Dense)               (None, 600, 64)      256         ['input_2[0][0]']                
                                                                                                  
 dense_56 (Dense)               (None, 600, 64)      256         ['input_2[0][0]']                
                                                                                                  
 dense_60 (Dense)               (None, 600, 64)      256         ['input_2[0][0]']                
                                                                                                  
 dense_64 (Dense)               (None, 600, 64)      256         ['input_2[0][0]']                
                                                                                                  
 dense_68 (Dense)               (None, 600, 64)      256         ['input_2[0][0]']                
                                                                                                  
 dense_72 (Dense)               (None, 600, 64)      256         ['input_2[0][0]']                
                                                                                                  
 dense_76 (Dense)               (None, 600, 64)      256         ['input_2[0][0]']                
                                                                                                  
 dense_41 (Dense)               (None, 600, 128)     8320        ['dense_40[0][0]']               
                                                                                                  
 dense_45 (Dense)               (None, 600, 128)     8320        ['dense_44[0][0]']               
                                                                                                  
 dense_49 (Dense)               (None, 600, 128)     8320        ['dense_48[0][0]']               
                                                                                                  
 dense_53 (Dense)               (None, 600, 128)     8320        ['dense_52[0][0]']               
                                                                                                  
 dense_57 (Dense)               (None, 600, 128)     8320        ['dense_56[0][0]']               
                                                                                                  
 dense_61 (Dense)               (None, 600, 128)     8320        ['dense_60[0][0]']               
                                                                                                  
 dense_65 (Dense)               (None, 600, 128)     8320        ['dense_64[0][0]']               
                                                                                                  
 dense_69 (Dense)               (None, 600, 128)     8320        ['dense_68[0][0]']               
                                                                                                  
 dense_73 (Dense)               (None, 600, 128)     8320        ['dense_72[0][0]']               
                                                                                                  
 dense_77 (Dense)               (None, 600, 128)     8320        ['dense_76[0][0]']               
                                                                                                  
 dense_42 (Dense)               (None, 600, 64)      8256        ['dense_41[0][0]']               
                                                                                                  
 dense_46 (Dense)               (None, 600, 64)      8256        ['dense_45[0][0]']               
                                                                                                  
 dense_50 (Dense)               (None, 600, 64)      8256        ['dense_49[0][0]']               
                                                                                                  
 dense_54 (Dense)               (None, 600, 64)      8256        ['dense_53[0][0]']               
                                                                                                  
 dense_58 (Dense)               (None, 600, 64)      8256        ['dense_57[0][0]']               
                                                                                                  
 dense_62 (Dense)               (None, 600, 64)      8256        ['dense_61[0][0]']               
                                                                                                  
 dense_66 (Dense)               (None, 600, 64)      8256        ['dense_65[0][0]']               
                                                                                                  
 dense_70 (Dense)               (None, 600, 64)      8256        ['dense_69[0][0]']               
                                                                                                  
 dense_74 (Dense)               (None, 600, 64)      8256        ['dense_73[0][0]']               
                                                                                                  
 dense_78 (Dense)               (None, 600, 64)      8256        ['dense_77[0][0]']               
                                                                                                  
 flatten_10 (Flatten)           (None, 38400)        0           ['dense_42[0][0]']               
                                                                                                  
 flatten_11 (Flatten)           (None, 38400)        0           ['dense_46[0][0]']               
                                                                                                  
 flatten_12 (Flatten)           (None, 38400)        0           ['dense_50[0][0]']               
                                                                                                  
 flatten_13 (Flatten)           (None, 38400)        0           ['dense_54[0][0]']               
                                                                                                  
 flatten_14 (Flatten)           (None, 38400)        0           ['dense_58[0][0]']               
                                                                                                  
 flatten_15 (Flatten)           (None, 38400)        0           ['dense_62[0][0]']               
                                                                                                  
 flatten_16 (Flatten)           (None, 38400)        0           ['dense_66[0][0]']               
                                                                                                  
 flatten_17 (Flatten)           (None, 38400)        0           ['dense_70[0][0]']               
                                                                                                  
 flatten_18 (Flatten)           (None, 38400)        0           ['dense_74[0][0]']               
                                                                                                  
 flatten_19 (Flatten)           (None, 38400)        0           ['dense_78[0][0]']               
                                                                                                  
 dense_43 (Dense)               (None, 1)            38401       ['flatten_10[0][0]']             
                                                                                                  
 dense_47 (Dense)               (None, 1)            38401       ['flatten_11[0][0]']             
                                                                                                  
 dense_51 (Dense)               (None, 1)            38401       ['flatten_12[0][0]']             
                                                                                                  
 dense_55 (Dense)               (None, 1)            38401       ['flatten_13[0][0]']             
                                                                                                  
 dense_59 (Dense)               (None, 1)            38401       ['flatten_14[0][0]']             
                                                                                                  
 dense_63 (Dense)               (None, 1)            38401       ['flatten_15[0][0]']             
                                                                                                  
 dense_67 (Dense)               (None, 1)            38401       ['flatten_16[0][0]']             
                                                                                                  
 dense_71 (Dense)               (None, 1)            38401       ['flatten_17[0][0]']             
                                                                                                  
 dense_75 (Dense)               (None, 1)            38401       ['flatten_18[0][0]']             
                                                                                                  
 dense_79 (Dense)               (None, 1)            38401       ['flatten_19[0][0]']             
                                                                                                  
 tf.math.reduce_mean_1 (TFOpLam  (None, 1)           0           ['dense_43[0][0]',               
 bda)                                                             'dense_47[0][0]',               
                                                                  'dense_51[0][0]',               
                                                                  'dense_55[0][0]',               
                                                                  'dense_59[0][0]',               
                                                                  'dense_63[0][0]',               
                                                                  'dense_67[0][0]',               
                                                                  'dense_71[0][0]',               
                                                                  'dense_75[0][0]',               
                                                                  'dense_79[0][0]']               
                                                                                                  
==================================================================================================
Total params: 552,330
Trainable params: 552,330
Non-trainable params: 0
__________________________________________________________________________________________________
===== MODEL 2 ======
Model: "model_2"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_3 (InputLayer)           [(None, 600, 3)]     0           []                               
                                                                                                  
 dense_80 (Dense)               (None, 600, 64)      256         ['input_3[0][0]']                
                                                                                                  
 dense_84 (Dense)               (None, 600, 64)      256         ['input_3[0][0]']                
                                                                                                  
 dense_88 (Dense)               (None, 600, 64)      256         ['input_3[0][0]']                
                                                                                                  
 dense_92 (Dense)               (None, 600, 64)      256         ['input_3[0][0]']                
                                                                                                  
 dense_96 (Dense)               (None, 600, 64)      256         ['input_3[0][0]']                
                                                                                                  
 dense_100 (Dense)              (None, 600, 64)      256         ['input_3[0][0]']                
                                                                                                  
 dense_104 (Dense)              (None, 600, 64)      256         ['input_3[0][0]']                
                                                                                                  
 dense_108 (Dense)              (None, 600, 64)      256         ['input_3[0][0]']                
                                                                                                  
 dense_112 (Dense)              (None, 600, 64)      256         ['input_3[0][0]']                
                                                                                                  
 dense_116 (Dense)              (None, 600, 64)      256         ['input_3[0][0]']                
                                                                                                  
 dense_81 (Dense)               (None, 600, 128)     8320        ['dense_80[0][0]']               
                                                                                                  
 dense_85 (Dense)               (None, 600, 128)     8320        ['dense_84[0][0]']               
                                                                                                  
 dense_89 (Dense)               (None, 600, 128)     8320        ['dense_88[0][0]']               
                                                                                                  
 dense_93 (Dense)               (None, 600, 128)     8320        ['dense_92[0][0]']               
                                                                                                  
 dense_97 (Dense)               (None, 600, 128)     8320        ['dense_96[0][0]']               
                                                                                                  
 dense_101 (Dense)              (None, 600, 128)     8320        ['dense_100[0][0]']              
                                                                                                  
 dense_105 (Dense)              (None, 600, 128)     8320        ['dense_104[0][0]']              
                                                                                                  
 dense_109 (Dense)              (None, 600, 128)     8320        ['dense_108[0][0]']              
                                                                                                  
 dense_113 (Dense)              (None, 600, 128)     8320        ['dense_112[0][0]']              
                                                                                                  
 dense_117 (Dense)              (None, 600, 128)     8320        ['dense_116[0][0]']              
                                                                                                  
 dense_82 (Dense)               (None, 600, 64)      8256        ['dense_81[0][0]']               
                                                                                                  
 dense_86 (Dense)               (None, 600, 64)      8256        ['dense_85[0][0]']               
                                                                                                  
 dense_90 (Dense)               (None, 600, 64)      8256        ['dense_89[0][0]']               
                                                                                                  
 dense_94 (Dense)               (None, 600, 64)      8256        ['dense_93[0][0]']               
                                                                                                  
 dense_98 (Dense)               (None, 600, 64)      8256        ['dense_97[0][0]']               
                                                                                                  
 dense_102 (Dense)              (None, 600, 64)      8256        ['dense_101[0][0]']              
                                                                                                  
 dense_106 (Dense)              (None, 600, 64)      8256        ['dense_105[0][0]']              
                                                                                                  
 dense_110 (Dense)              (None, 600, 64)      8256        ['dense_109[0][0]']              
                                                                                                  
 dense_114 (Dense)              (None, 600, 64)      8256        ['dense_113[0][0]']              
                                                                                                  
 dense_118 (Dense)              (None, 600, 64)      8256        ['dense_117[0][0]']              
                                                                                                  
 flatten_20 (Flatten)           (None, 38400)        0           ['dense_82[0][0]']               
                                                                                                  
 flatten_21 (Flatten)           (None, 38400)        0           ['dense_86[0][0]']               
                                                                                                  
 flatten_22 (Flatten)           (None, 38400)        0           ['dense_90[0][0]']               
                                                                                                  
 flatten_23 (Flatten)           (None, 38400)        0           ['dense_94[0][0]']               
                                                                                                  
 flatten_24 (Flatten)           (None, 38400)        0           ['dense_98[0][0]']               
                                                                                                  
 flatten_25 (Flatten)           (None, 38400)        0           ['dense_102[0][0]']              
                                                                                                  
 flatten_26 (Flatten)           (None, 38400)        0           ['dense_106[0][0]']              
                                                                                                  
 flatten_27 (Flatten)           (None, 38400)        0           ['dense_110[0][0]']              
                                                                                                  
 flatten_28 (Flatten)           (None, 38400)        0           ['dense_114[0][0]']              
                                                                                                  
 flatten_29 (Flatten)           (None, 38400)        0           ['dense_118[0][0]']              
                                                                                                  
 dense_83 (Dense)               (None, 1)            38401       ['flatten_20[0][0]']             
                                                                                                  
 dense_87 (Dense)               (None, 1)            38401       ['flatten_21[0][0]']             
                                                                                                  
 dense_91 (Dense)               (None, 1)            38401       ['flatten_22[0][0]']             
                                                                                                  
 dense_95 (Dense)               (None, 1)            38401       ['flatten_23[0][0]']             
                                                                                                  
 dense_99 (Dense)               (None, 1)            38401       ['flatten_24[0][0]']             
                                                                                                  
 dense_103 (Dense)              (None, 1)            38401       ['flatten_25[0][0]']             
                                                                                                  
 dense_107 (Dense)              (None, 1)            38401       ['flatten_26[0][0]']             
                                                                                                  
 dense_111 (Dense)              (None, 1)            38401       ['flatten_27[0][0]']             
                                                                                                  
 dense_115 (Dense)              (None, 1)            38401       ['flatten_28[0][0]']             
                                                                                                  
 dense_119 (Dense)              (None, 1)            38401       ['flatten_29[0][0]']             
                                                                                                  
 tf.math.reduce_mean_2 (TFOpLam  (None, 1)           0           ['dense_83[0][0]',               
 bda)                                                             'dense_87[0][0]',               
                                                                  'dense_91[0][0]',               
                                                                  'dense_95[0][0]',               
                                                                  'dense_99[0][0]',               
                                                                  'dense_103[0][0]',              
                                                                  'dense_107[0][0]',              
                                                                  'dense_111[0][0]',              
                                                                  'dense_115[0][0]',              
                                                                  'dense_119[0][0]']              
                                                                                                  
==================================================================================================
Total params: 552,330
Trainable params: 552,330
Non-trainable params: 0
__________________________________________________________________________________________________
===== MODEL (used for all steps) ======
Model: "model_3"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_4 (InputLayer)        [(None, 600, 3)]          0         
                                                                 
 dense_120 (Dense)           (None, 600, 50)           200       
                                                                 
 dense_121 (Dense)           (None, 600, 50)           2550      
                                                                 
 flatten_30 (Flatten)        (None, 30000)             0         
                                                                 
 dense_123 (Dense)           (None, 1)                 30001     
                                                                 
=================================================================
Total params: 32,751
Trainable params: 32,751
Non-trainable params: 0
_________________________________________________________________
ITERATION: 1
RUNNING STEP 1
Epoch 1/20
967/967 - 5s - loss: 0.6266 - accuracy: 0.6699 - val_loss: 0.6244 - val_accuracy: 0.6790 - lr: 1.0000e-04 - 5s/epoch - 5ms/step
Epoch 2/20
967/967 - 2s - loss: 0.6225 - accuracy: 0.6743 - val_loss: 0.6191 - val_accuracy: 0.6751 - lr: 1.0000e-04 - 2s/epoch - 2ms/step
Epoch 3/20
967/967 - 2s - loss: 0.6199 - accuracy: 0.6750 - val_loss: 0.6217 - val_accuracy: 0.6737 - lr: 1.0000e-04 - 2s/epoch - 2ms/step
Epoch 4/20
967/967 - 2s - loss: 0.6173 - accuracy: 0.6775 - val_loss: 0.6119 - val_accuracy: 0.6817 - lr: 1.0000e-04 - 2s/epoch - 2ms/step
Epoch 5/20
967/967 - 2s - loss: 0.6155 - accuracy: 0.6784 - val_loss: 0.6161 - val_accuracy: 0.6759 - lr: 1.0000e-04 - 2s/epoch - 2ms/step
Epoch 6/20
967/967 - 2s - loss: 0.6151 - accuracy: 0.6791 - val_loss: 0.6181 - val_accuracy: 0.6734 - lr: 1.0000e-04 - 2s/epoch - 2ms/step
Epoch 7/20
967/967 - 2s - loss: 0.6125 - accuracy: 0.6799 - val_loss: 0.6134 - val_accuracy: 0.6770 - lr: 1.0000e-04 - 2s/epoch - 2ms/step
Epoch 8/20
